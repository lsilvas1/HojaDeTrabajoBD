package com.umg.connection;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.umg.connection.conexion.MySQLConnectionManager;
public class Main {
public static void main(String[] args) {
leerGraduandos();
}
    public static void leerGraduandos() {
        Connection conn = MySQLConnectionManager.getConnection();
        if (conn != null) {
            try {
                String consulta = "SELECT * FROM estudiantes";
                PreparedStatement statement = conn.prepareStatement(consulta);
                ResultSet resultSet = statement.executeQuery();
                while (resultSet.next()) {
                    int idEstudiante = resultSet.getInt("idestudiante");
                    String primerNombre = resultSet.getString("primernombre");
                    String segundoNombre = resultSet.getString("segundonombre");
                    String otroNombre = resultSet.getString ("otronombre");
                    String primerApellido = resultSet.getString ("primerapellido");
                    String segundoApellido = resultSet.getString ("segundoapellido");
                    String otroApellido = resultSet.getString ("otroapellido");
                    String genero = resultSet.getString ("genero");
                    String fechaNacimiento = resultSet.getString ("fechanacimiento");
                    String numeroTelefono = resultSet.getString ("telefono");
                    String numeroDpi = resultSet.getString ("dpi");
                    String colegiatura = resultSet.getString ("colegiatura");
                    String fechaCreacion = resultSet.getString ("fecha_creacion");
                    String usuarioCreacion = resultSet.getString ("usuario_creacion");
                    System.out.println("idestudiante: " + idEstudiante + ", primernombre: " + primerNombre + ", segundonombre " + segundoNombre + ", otronombre: " + otroNombre + "primerapellido: "+ primerApellido + "segundoapellido: "+ segundoApellido + "segundoapellido : "+ otroApellido + "otroapellido" + genero + "genero: " + fechaNacimiento + "fechanacimiento: "+ numeroTelefono + "telefono: "+ numeroDpi + "dpi" + colegiatura + " colegiatura:"+ fechaCreacion + "fecha_creacion" + usuarioCreacion + "usuario_creacion"
                    );
                }
                resultSet.close();
                statement.close();
                conn.close();
            } catch (SQLException e) {
                System.out.println("Error al leer datos: " + e.getMessage());
            }
        } else {
            System.out.println("No se pudo establecer la conexi√≥n.");
        }
    }
}
